#! /usr/bin/env bash
# enable the screen
if (( $(xbacklight -get) < 1 )); then
	xbacklight -set 80
fi

# locks using i3lock and xautlock (if running)
if [[ "$1" == "--try-autolock" ]] && [[ "$(pgrep -cx xautolock)" -ge 1 ]]; then
	xautolock -locknow
else
	( xset +dpms dpms 10 10 10 \
	&& i3lock -n \
	    --color=333333 \
	    --ignore-empty-password \
	    --show-failed-attempts \
	&& xset dpms 0 0 0 ) & disown
	# Clear cached passwords
fi
pkill -SIGHUP gpg-agent
echo "gpg-agent cache cleared"
