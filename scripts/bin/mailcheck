#!/bin/bash

if [[ -z "$DISPLAY" ]]; then
	. /home/timo/bin/active-xsession
fi

MAILDIRS=(
"$HOME/Mail/yahoo/inbox"
"$HOME/Mail/gmx/inbox"
)
nmc="$HOME/Mail/newmailcount"

#count new mail and update summary head
NEWMAILCOUNT() {
    #to summary
    for i in "${MAILDIRS[@]}"
    do
		NEW="$(find "$i/new" -type f | wc -l)"
		(( TOT+=NEW ))
    done

	echo $TOT
}

if [[ -e $nmc ]]; then
	CNT=$(<$nmc)
else
	CNT=0
fi

NEW="$(NEWMAILCOUNT)"
if [[ $NEW -gt $CNT ]]; then
	notify-send "New mail" "$NEW new mail(s)" --urgency=normal
fi
echo $NEW > $nmc
