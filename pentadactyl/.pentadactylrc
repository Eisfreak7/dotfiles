" vim: set ft=pentadactyl:

" Initialisation
loadplugins '\.(js|penta)$'
group user
set cdpath=''

" Search engines {{{
set defsearch=duckduckgo
silent bmark -title="Subreddit"   -keyword="r"   "www.reddit.com/r/%s/"
silent bmark -title="Leo Es - De" -keyword="lsd" "dict.leo.org/esde/#/search=%s"
silent bmark -title="Leo En - De" -keyword="led" "dict.leo.org/ende/#/search=%s"
silent bmark -title="Arch Wiki"   -keyword="aw"  "wiki.archlinux.org/index.php?search=%s"
silent bmark -title="Youtube"     -keyword="yt"  "www.youtube.com/results?search_type=search_videos&search_sort=relevance&search_query=%s&search=Search"

" Quick marks {{{
delqmarks!
silent qmark r www.reddit.com
silent qmark R www.reddit.com/r/Dashboard
silent qmark w web.whatsapp.com
silent qmark f www.feedly.com
silent qmark F www.facebook.de
silent qmark p www.getpocket.com/a/queue/list
silent qmark t www.tvshowtime.com
" Pyload
silent qmark P localhost:8000

" Settings {{{
set passkeys&
set passkeys+=feedly.com:jkrs
set passkeys+=duolingo.com/practice:<Enter>
set passkeys+=reddit.com:jkp√∂+-<C-C><C-Enter><Enter>
set passkeys+=duckduckgo.com:jk<Enter>
set passkeys+=getpocket.com:jka?<A-1><A-2><A-3><A-5><Enter>

set hintkeys="hsdfgyuiopqwertnmzxcvbHSDFGYUIOPQWERTNMZXCVB"

" No scrollbars
set guioptions-=r
set guioptions-=b

" Appearance {{{
colorscheme solarized-dark
highlight Hint font-size:12;color:white;background-color:red;padding:2px

" Commands {{{
command! -nargs=0 mpv :silent :execute "!mpv '" + content.location.href + "' &"
command! -nargs=0 feh :silent :execute "!feh '" + content.location.href + "' &"
command! -nargs=0 qute :silent :execute "!qutebrowser '" + content.location.href + "' &"

" Mappings {{{
nmap <Space> <Leader>
nmap -builtin , :
nmap -builtin j 5j
nmap -builtin k 5k

nmap -builtin <Leader>m :mpv<CR>d
nmap -builtin <Leader>q :qute<CR>d

nmap <Leader>c nohlsearch

" Open a new tab in the background
map T :tabopen! 

" Move tab
nmap -builtin <C-S-h> :tabmove -1<CR>
nmap -builtin <C-S-l> :tabmove +1<CR>

" Re-Source
nmap -builtin <Leader>rs :source ~/.pentadactylrc<CR>:echo "Settings reloaded"<CR>

" Tab detach
nmap -builtin <Leader>td :tabdetach<CR>

" Edit pentadactylrc
nmap -builtin <Leader>er :!vim -g ~/.pentadactylrc<CR>

" Use <BS> to return to previous tab
nmap -builtin <BS> <C-^>

" Use h,l to move left,right between tabs
nmap -builtin <C-h> :tabprevious<CR>
nmap -builtin <C-l> :tabnext<CR>

" Select all
imap -builtin <C-S-a> <C-Home><C-S-End>

" Autocmds {{{
autocmd!
"autocmd PageLoad youtube.com :execute "!mpv '<url>' &" | tabclose '<tab>'

" Browser Settings {{{
" General
set! browser.startup.homepage="about:blank"
set! browser.newtab.url="about:blank"
set! browser.search.selectedEngine="DuckDuckGo"
set! browser.search.defaultenginename="DuckDuckGo"
set! browser.bookmarks.restore_default_bookmarks=false
set! browser.download.lastDir=""
set! browser.tabs.closeWindowWithLastTab=false
set! browser.tabs.warnOnClose=false

" Privacy
set! privacy.clearOnShutdown.cache=false
set! privacy.clearOnShutdown.cookies=false
set! privacy.clearOnShutdown.downloads=true
set! privacy.clearOnShutdown.formdata=true
set! privacy.clearOnShutdown.history=false
set! privacy.clearOnShutdown.offlineApps=true
set! privacy.clearOnShutdown.passwords=true
set! privacy.clearOnShutdown.sessions=true
set! privacy.clearOnShutdown.siteSettings=true
set! privacy.donottrackheader.enabled=true

" Noscript
set! noscript.untrusted="google-analytics.com http://google-analytics.com https://google-analytics.com"
" Pocket
set! extensions.isreaditlater.autoCloseTab=true
" Ghostery
set! extensions.firefox@ghostery.com.install-event-fired=true

command! PlugInstall -nargs=0 -description "Install my addons" -javascript <<EOF
	// Addons from mozilla.org
	var ext = [];
	ext.push("9609");   // Ghostery
	ext.push("452714"); // Pushbullet
	ext.push("387429"); // Reddit Enhancement Suite
	ext.push("7661");   // Pocket
	ext.push("722");    // NoScript
	for(var i=0; i<ext.length; i++) {
		dactyl.execute("extadd https://addons.mozilla.org/firefox/downloads/latest/" + ext[i] + "/addon-" + ext[i] + "-latest.xpi")
	}

	// HTTPS-Everywhere
	dactyl.execute("extadd https://www.eff.org/files/https-everywhere-latest.xpi")

	// GNotifier
	dactyl.execute("extadd https://addons.mozilla.org/firefox/downloads/file/309172/gnotifier-1.8.9-sm+tb+fx-linux.xpi?src=dp-btn-primary")
	
	// uBlock Origin
	dactyl.execute("extadd https://addons.mozilla.org/firefox/downloads/file/312228/ublock_origin-0.9.5.0-an+sm+fx.xpi?src=dp-btn-primary")
EOF

